import streamlit as st
import pandas as pd

# 1. PDF ê¸°ì¤€ì— ë”°ë¥¸ ê°€ìƒ DB(ì—‘ì…€ ë°ì´í„°) ìƒì„±
def create_mock_data():
    data = {
        'ê¸°ê´€ëª…': ['(ì£¼)ì‹œìŠ¤ì½˜ë¡œë³´í‹±ìŠ¤', 'ì—ì´ì•„ì´ì”¨ì—”í‹°(ì£¼)', 'í”„ë¢°ë²¨êµìœ¡ì›', 'ãˆœê°€ìƒí…Œí¬', 'ãˆœí˜ì‹ AI'],
        'ê³¼ì œëª…': ['ììœ¨ì œì¡° ì‹œìŠ¤í…œ ê°œë°œ', 'í•™ìŠµ í”Œë«í¼ ê°œë°œ', 'í•™ìŠµ í”Œë«í¼ ê°œë°œ(ê³µë™)', 'ì‹ ê·œ ë¡œë´‡ ê¸°ìˆ ', 'AI ì§„ë‹¨ ì†”ë£¨ì…˜'],
        'êµ¬ë¶„': ['ì£¼ê´€', 'ì£¼ê´€', 'ê³µë™', 'ì£¼ê´€', 'ì£¼ê´€'],
        'ìë³¸ì´ê³„': [500000000, 100000000, -50000000, 100000000, 80000000],  # í”„ë¢°ë²¨ì€ ìë³¸ì ì‹ ì„¤ì •
        'ë¶€ì±„ì´ê³„': [200000000, 150000000, 300000000, 600000000, 300000000],  # ê°€ìƒí…Œí¬ëŠ” ë¶€ì±„ 500% ì´ˆê³¼
        'ìœ ë™ìì‚°': [300000000, 200000000, 50000000, 100000000, 120000000],
        'ìœ ë™ë¶€ì±„': [100000000, 100000000, 100000000, 250000000, 100000000]
    }
    return pd.DataFrame(data)

# 2. ê²€í†  ë¡œì§ í•¨ìˆ˜ (PDF [ë³„í‘œ 2] ê¸°ì¤€ ì ìš©)
def check_eligibility(row):
    # ë¶€ì±„ë¹„ìœ¨ ë° ìœ ë™ë¹„ìœ¨ ê³„ì‚°
    debt_ratio = (row['ë¶€ì±„ì´ê³„'] / row['ìë³¸ì´ê³„']) * 100 if row['ìë³¸ì´ê³„'] > 0 else 9999
    current_ratio = (row['ìœ ë™ìì‚°'] / row['ìœ ë™ë¶€ì±„']) * 100
    
    # 6ë²ˆ ê¸°ì¤€: ìë³¸ì „ì•¡ì ì‹ ì—¬ë¶€ [cite: 67]
    if row['ìë³¸ì´ê³„'] <= 0:
        return "âŒ ì‚¬ì „ì§€ì›ì œì™¸ (ìë³¸ì „ì•¡ì ì‹)"
    
    # 5ë²ˆ ê¸°ì¤€: ë¶€ì±„ë¹„ìœ¨ 500% ì´ìƒ ë˜ëŠ” ìœ ë™ë¹„ìœ¨ 50% ì´í•˜ [cite: 64]
    if debt_ratio >= 500 or current_ratio <= 50:
        return "âŒ ì‚¬ì „ì§€ì›ì œì™¸ (ë¶€ì±„ë¹„ìœ¨ 500%â†‘ ë˜ëŠ” ìœ ë™ 50%â†“)"
    
    # ì‚¬í›„ê´€ë¦¬ ëŒ€ìƒ ê¸°ì¤€: ë¶€ì±„ 300%â†‘ ë˜ëŠ” ìœ ë™ 100%â†“ [cite: 64]
    if debt_ratio >= 300 or current_ratio <= 100:
        return "âš ï¸ ì‚¬í›„ê´€ë¦¬ ëŒ€ìƒ"
    
    return "âœ… ì •ìƒ"

# 3. Streamlit í™”ë©´ êµ¬ì„±
st.title("ğŸš€ ë”¥í…Œí¬ ìŠ¤ì¼€ì¼ì—…ë°¸ë¦¬ ì‚¬ì „ê²€í†  ì‹œìŠ¤í…œ")
st.write("ì²¨ë¶€íŒŒì¼ [ë³„í‘œ 2]ì˜ ê²€í†  ì„¸ë¶€ê¸°ì¤€ì— ë”°ë¥¸ ìë™ íŒë… ê²°ê³¼ì…ë‹ˆë‹¤.")

df = create_mock_data()
df['ê²€í† ê²°ê³¼'] = df.apply(check_eligibility, axis=1)

# ê²°ê³¼ ì¶œë ¥
st.subheader("1. ê³¼ì œë³„ ì‚¬ì „ê²€í†  í˜„í™©")
st.dataframe(df.style.apply(lambda x: ['background-color: #ffcccc' if 'âŒ' in str(v) else '' for v in x], axis=1))

st.subheader("2. ìš”ì•½ ë¦¬í¬íŠ¸")
excluded_count = len(df[df['ê²€í† ê²°ê³¼'].str.contains("ì‚¬ì „ì§€ì›ì œì™¸")])
st.error(f"ì´ {len(df)}ê±´ ì¤‘ {excluded_count}ê±´ì´ ì‚¬ì „ì§€ì›ì œì™¸ ëŒ€ìƒìœ¼ë¡œ íŒë³„ë˜ì—ˆìŠµë‹ˆë‹¤.")
