def check_and_guide(capital, debt, pi_projects):
    debt_ratio = (debt / capital * 100) if capital > 0 else 9999
    results = []

    # 1. 자본잠식 (지침 제5호 6번)
    if capital <= 0:
        results.append({
            "항목": "자본 건전성",
            "진단": "❌ 사전지원제외 대상",
            "원인": "최근 회계연도 말 결산 기준 '자본전액잠식' 상태입니다. [지침 별표2 제5호]",
            "해결책": "주관연구개발기관 및 연구책임자는 변경할 수 없으나, 문제가 되는 공동연구기관을 제외하여 사유를 해소하면 선정평가에 상정될 수 있습니다. [지침 제8호]"
        })

    # 2. 부채비율 (지침 제5호 5번)
    if debt_ratio >= 500:
        results.append({
            "항목": "부채 비율",
            "진단": "❌ 사전지원제외 대상",
            "원인": f"부채비율이 {debt_ratio:.1f}%로 기준치(500%)를 초과했습니다.",
            "해결책": "업력 5년 미만 기업인지 확인해 보세요. 해당되지 않는다면 자본 확충 등을 통해 비율을 낮춰야 합니다."
        })

    # 3. 3책 5공 (지침 제6호)
    if pi_projects > 3:
        results.append({
            "항목": "연구자 참여 제한",
            "진단": "❌ 사전지원제외 대상",
            "원인": "연구책임자가 동시에 수행 중인 과제가 3개를 초과합니다. [지침 제6호]",
            "해결책": "협약 월 기준 6개월 이내 종료 과제가 있는지 확인하거나, 연구책임자를 변경하여 신청해야 합니다."
        })

    return results
